package com.musicode.photogallery;

import android.net.Uri;
import android.util.Log;

import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.net.HttpURLConnection;
import java.net.URL;
import java.util.ArrayList;
import java.util.List;

public class FlickrFetchr {

    private static final String TAG = "FlickrFetchr";
    private static final String API_KEY = "cbdf5a22e813b0ef328a2d7933e8c931";

    public byte[] getUrlBytes(String urlStr) throws IOException {

        URL url = new URL(urlStr);
        HttpURLConnection connection = (HttpURLConnection) url.openConnection();

        try {
            ByteArrayOutputStream out = new ByteArrayOutputStream();
            InputStream in = connection.getInputStream();

            if (connection.getResponseCode() != HttpURLConnection.HTTP_OK) {
                throw new IOException(connection.getResponseMessage() + ": with " + urlStr);
            }

            int bytesRead = 0;
            byte[] buffer = new byte[1024];
            while ((bytesRead = in.read(buffer)) > 0) {
                out.write(buffer, 0, bytesRead);
            }

            out.close();
            return out.toByteArray();
        }
        finally {
            connection.disconnect();
        }
    }

    public String getUrlString(String urlStr) throws IOException {
        return new String(getUrlBytes(urlStr));
    }

    public List<GalleryItem> fetchItems() {

        List<GalleryItem> items = new ArrayList<>();

        try {
            String url = Uri.parse("https://api.flickr.com/services/rest/")
                    .buildUpon()
                    .appendQueryParameter("method", "flickr.photos.getRecent")
                    .appendQueryParameter("api_key", API_KEY)
                    .appendQueryParameter("format", "json")
                    .appendQueryParameter("nojsoncallback", "1")
                    .appendQueryParameter("extras", "url_s")
                    .build()
                    .toString();

            String json = getUrlString(url);
            Log.d(TAG, json);
//            String json = "{\"photos\":{\"page\":1,\"pages\":10,\"perpage\":100,\"total\":1000,\"photo\":[{\"id\":\"34261618574\",\"owner\":\"144100037@N06\",\"secret\":\"7d603ee987\",\"server\":\"4205\",\"farm\":5,\"title\":\"5934d47ff3d88.jpg\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34261624794\",\"owner\":\"94933391@N05\",\"secret\":\"35a4a83a7d\",\"server\":\"4259\",\"farm\":5,\"title\":\"P1020545\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34261626134\",\"owner\":\"132103228@N05\",\"secret\":\"73fdd15a6e\",\"server\":\"4272\",\"farm\":5,\"title\":\"TODAY ONLY * FATHER'S DAY SPECIAL * 20\\u2105 OFF EVERYTHING PLUS FREE SHIPPING ANYWHERE * https:\\/\\/society6.com\\/johnlymanphotos\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34261630184\",\"owner\":\"150228473@N06\",\"secret\":\"299bdda58a\",\"server\":\"4247\",\"farm\":5,\"title\":\"Drop Dead Darlings DSOTR\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34261637404\",\"owner\":\"132791403@N08\",\"secret\":\"36c69b5c88\",\"server\":\"4254\",\"farm\":5,\"title\":\"IP Camera E-mail Alert-md snap(2017-06-05 12:48:58)\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34261641394\",\"owner\":\"49433883@N00\",\"secret\":\"172ac68c47\",\"server\":\"4272\",\"farm\":5,\"title\":\"Chali Hernandez - Cumbanchero II @segundoruizbelvis\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34261642674\",\"owner\":\"149236660@N05\",\"secret\":\"74a53a641d\",\"server\":\"4196\",\"farm\":5,\"title\":\"EAST VILLAGE \\u20222 Bedroom in Prime East Village Location! \\u2022Boasting 9 foot ceilings, hardwood floors, exposed brick and tons of natural light! \\u2022$3250 monthly  Contact Michael Hargrove Phone: 862-232-7023 Email: mikehargrove@fifthandforever.com @mr_m_h  #fif\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34261644494\",\"owner\":\"35809900@N05\",\"secret\":\"5622236589\",\"server\":\"4262\",\"farm\":5,\"title\":\"Robert on film\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34261647724\",\"owner\":\"61493316@N00\",\"secret\":\"901d0c7d54\",\"server\":\"4229\",\"farm\":5,\"title\":\"TEAR IT UP 2017\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34295741653\",\"owner\":\"137638223@N03\",\"secret\":\"c149586627\",\"server\":\"4290\",\"farm\":5,\"title\":\"Bloomsky Enschede (June 5, 2017 at 05:47AM)\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34295741913\",\"owner\":\"12238277@N04\",\"secret\":\"a3c4538b25\",\"server\":\"4233\",\"farm\":5,\"title\":\"The perfect place for a Saab\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34295759293\",\"owner\":\"24917258@N05\",\"secret\":\"d1d9aecc08\",\"server\":\"4290\",\"farm\":5,\"title\":\"IMG_4817\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34295759833\",\"owner\":\"148663186@N08\",\"secret\":\"ab2aaac2d2\",\"server\":\"4212\",\"farm\":5,\"title\":\"Ciudad de Panam\\u00e1\\u2026 (Despu\\u00e9s)\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34719045210\",\"owner\":\"99483302@N08\",\"secret\":\"515ee4b711\",\"server\":\"4262\",\"farm\":5,\"title\":\"20170605054744.jpg\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34719048130\",\"owner\":\"62505753@N08\",\"secret\":\"b6bd7ebc2d\",\"server\":\"4229\",\"farm\":5,\"title\":\"2017_Millers_1700\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34719050460\",\"owner\":\"146550793@N08\",\"secret\":\"5b0210f82b\",\"server\":\"4263\",\"farm\":5,\"title\":\"Yudis Dwiko, dari Nasyid ke Urban Pop dan Hip-Hop\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34719051620\",\"owner\":\"147625234@N07\",\"secret\":\"8025c8e045\",\"server\":\"4247\",\"farm\":5,\"title\":\"2017-06-05_12-48-27\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34719052630\",\"owner\":\"87246644@N07\",\"secret\":\"a09dbdcb1e\",\"server\":\"4236\",\"farm\":5,\"title\":\"dsc_0812\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34719058640\",\"owner\":\"133467058@N03\",\"secret\":\"3ea18280e7\",\"server\":\"4225\",\"farm\":5,\"title\":\"MTA New York City Subway 1969-70 St. Louis Car R-42 #4874 on the QJ train. 6\\/8\\/1970.\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34719062320\",\"owner\":\"147235904@N08\",\"secret\":\"d85bb1c805\",\"server\":\"4206\",\"farm\":5,\"title\":\"D\\u1ef1 \\u0111o\\u00e1n Boston River VS CA Penarol, 05h30 ng\\u00e0y 6\\/6\\/2017\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34719063490\",\"owner\":\"149429292@N06\",\"secret\":\"7365b13e3e\",\"server\":\"4251\",\"farm\":5,\"title\":\"sesion-89.jpg\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34719065970\",\"owner\":\"93999044@N06\",\"secret\":\"eefebd4065\",\"server\":\"4242\",\"farm\":5,\"title\":\"Marcus Prom 2017\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34719068300\",\"owner\":\"26420774@N04\",\"secret\":\"7a1235807d\",\"server\":\"4238\",\"farm\":5,\"title\":\"Sugar Sugar - Strange Magic\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34719069660\",\"owner\":\"9429901@N04\",\"secret\":\"9230b5f235\",\"server\":\"4233\",\"farm\":5,\"title\":\"IMG_2257\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34719070370\",\"owner\":\"154987019@N03\",\"secret\":\"af282636dd\",\"server\":\"4203\",\"farm\":5,\"title\":\"spitsthetruth_December_20__2016_at_1132AM_httpspitsthetruth.tumblr.compost154724895738nash-grier\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34719070460\",\"owner\":\"135184975@N08\",\"secret\":\"f0819d2fb5\",\"server\":\"4211\",\"farm\":5,\"title\":\"\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34941086122\",\"owner\":\"113206454@N02\",\"secret\":\"82b419d504\",\"server\":\"4203\",\"farm\":5,\"title\":\"Knockin' on Heaven's Door, MGM Grand, Las Vegas\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34941086312\",\"owner\":\"132239222@N05\",\"secret\":\"2abc0c4fdf\",\"server\":\"4266\",\"farm\":5,\"title\":\"Me meets his closest cousins \\u2764\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34941086572\",\"owner\":\"150451601@N02\",\"secret\":\"e098a883c4\",\"server\":\"4248\",\"farm\":5,\"title\":\"Life : New Funny Minion Pictures And Quotes - September 29, 2015\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34941088502\",\"owner\":\"130539687@N04\",\"secret\":\"42ab750e6a\",\"server\":\"4238\",\"farm\":5,\"title\":\"IMG_20170530_191608\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34941088632\",\"owner\":\"149363851@N07\",\"secret\":\"a09a3a68f9\",\"server\":\"4285\",\"farm\":5,\"title\":\"Photo\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34941091752\",\"owner\":\"155389924@N02\",\"secret\":\"3578edd00f\",\"server\":\"4207\",\"farm\":5,\"title\":\"2017-06-04_11-48-11\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34941092612\",\"owner\":\"132658546@N07\",\"secret\":\"07877c6887\",\"server\":\"4203\",\"farm\":5,\"title\":\"Mencoba sesuatu yg baru.\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34941093772\",\"owner\":\"148975574@N05\",\"secret\":\"7e3fb27fa0\",\"server\":\"4267\",\"farm\":5,\"title\":\"El color de la vida\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34941100542\",\"owner\":\"132034631@N07\",\"secret\":\"10cefebea5\",\"server\":\"4211\",\"farm\":5,\"title\":\"IMG_2561\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34941100762\",\"owner\":\"45762324@N05\",\"secret\":\"6e708d762a\",\"server\":\"4201\",\"farm\":5,\"title\":\"Volks Betoneira\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34941107572\",\"owner\":\"83259480@N02\",\"secret\":\"a98de0c113\",\"server\":\"4280\",\"farm\":5,\"title\":\"Just start.\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34941108952\",\"owner\":\"33473816@N00\",\"secret\":\"efaec5f787\",\"server\":\"4283\",\"farm\":5,\"title\":\"Photo\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34941112952\",\"owner\":\"24673084@N04\",\"secret\":\"413833e7f5\",\"server\":\"4214\",\"farm\":5,\"title\":\"Balance of baseball\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34941116352\",\"owner\":\"45114839@N00\",\"secret\":\"efa8ab21e5\",\"server\":\"4271\",\"farm\":5,\"title\":\"Appalachian Golden Classics Car Show 2017\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34941117132\",\"owner\":\"94218502@N03\",\"secret\":\"3d98b1dd52\",\"server\":\"4219\",\"farm\":5,\"title\":\"DSC08545.jpg\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34941118522\",\"owner\":\"144820349@N04\",\"secret\":\"ef99f47e80\",\"server\":\"4209\",\"farm\":5,\"title\":\"Top 10 Craziest Shots In The History Of Cricket\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34941120372\",\"owner\":\"75389015@N05\",\"secret\":\"b54105eb04\",\"server\":\"4217\",\"farm\":5,\"title\":\"IMG_8446.jpg\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34941120622\",\"owner\":\"149058190@N04\",\"secret\":\"cc66b70454\",\"server\":\"4281\",\"farm\":5,\"title\":\"4pnqfR\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34941121992\",\"owner\":\"128866397@N07\",\"secret\":\"d237b17170\",\"server\":\"4290\",\"farm\":5,\"title\":\"MSGT Release 2017\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34941122342\",\"owner\":\"54266950@N06\",\"secret\":\"d422148618\",\"server\":\"4247\",\"farm\":5,\"title\":\"20170526_212718\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34941122482\",\"owner\":\"150185980@N02\",\"secret\":\"fb2a849a18\",\"server\":\"4231\",\"farm\":5,\"title\":\"Screenshot_2017-06-04-22-44-03\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34941122742\",\"owner\":\"150391964@N07\",\"secret\":\"1b4e2f28b5\",\"server\":\"4205\",\"farm\":5,\"title\":\"Like my new pants\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34941122902\",\"owner\":\"23849931@N08\",\"secret\":\"bbd6fe13fe\",\"server\":\"4278\",\"farm\":5,\"title\":\"Glessner House\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34941122972\",\"owner\":\"22058355@N06\",\"secret\":\"999ebffa62\",\"server\":\"4247\",\"farm\":5,\"title\":\"Puerto Vallarta 2017\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34941125322\",\"owner\":\"61322930@N02\",\"secret\":\"07348bb637\",\"server\":\"4249\",\"farm\":5,\"title\":\"I love her! #cousin #sister #redvelvet #toosweet\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34941125522\",\"owner\":\"151368951@N02\",\"secret\":\"c93f209d27\",\"server\":\"4201\",\"farm\":5,\"title\":\"IMG_20170519_130955.jpg\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34941125812\",\"owner\":\"133768082@N04\",\"secret\":\"30be240647\",\"server\":\"4233\",\"farm\":5,\"title\":\"Rita Kirkman_049\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34975028391\",\"owner\":\"62991404@N06\",\"secret\":\"5283cce3b1\",\"server\":\"4223\",\"farm\":5,\"title\":\"Record by Always E-mail, 2017-06-04 22:48:07\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34975029011\",\"owner\":\"69611530@N03\",\"secret\":\"c420e52aac\",\"server\":\"4242\",\"farm\":5,\"title\":\"\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34975029651\",\"owner\":\"117766754@N07\",\"secret\":\"dea2653c5c\",\"server\":\"4195\",\"farm\":5,\"title\":\"2017-06-05_05-48-21\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34975031671\",\"owner\":\"130960286@N02\",\"secret\":\"349db890c9\",\"server\":\"4214\",\"farm\":5,\"title\":\"DSC_0880.jpg\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34975034731\",\"owner\":\"92663500@N00\",\"secret\":\"3f6dc8b7d5\",\"server\":\"4252\",\"farm\":5,\"title\":\"\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34975035941\",\"owner\":\"151117192@N04\",\"secret\":\"2da2ce9374\",\"server\":\"4207\",\"farm\":5,\"title\":\"Violence in Portland \\u2013 Dueling Trump Protests as Antifa Retreats, 14 People Arrested (VIDEOS)\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34975036081\",\"owner\":\"126091722@N02\",\"secret\":\"6aff9bcc6e\",\"server\":\"4278\",\"farm\":5,\"title\":\"_KAI0205.jpg\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34975037031\",\"owner\":\"155377476@N05\",\"secret\":\"08da85a864\",\"server\":\"4261\",\"farm\":5,\"title\":\"Portland trip!\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34975038281\",\"owner\":\"98965921@N06\",\"secret\":\"c65a859437\",\"server\":\"4278\",\"farm\":5,\"title\":\"A23 Email marketing\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34975041501\",\"owner\":\"33573397@N05\",\"secret\":\"1d0985d29c\",\"server\":\"4267\",\"farm\":5,\"title\":\"Summertime!\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34975043101\",\"owner\":\"79424404@N00\",\"secret\":\"0646291a7c\",\"server\":\"4206\",\"farm\":5,\"title\":\"[WebCam]\\u30bb\\u30f3\\u30b5\\u30fc\\u304c\\u4f5c\\u52d5\\u3057\\u307e\\u3057\\u305f\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34975043471\",\"owner\":\"32194752@N00\",\"secret\":\"5e3b831075\",\"server\":\"4248\",\"farm\":5,\"title\":\"IMG_5454-Edit.jpg\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34975044681\",\"owner\":\"10058483@N00\",\"secret\":\"570d0d1167\",\"server\":\"4275\",\"farm\":5,\"title\":\"\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34975044801\",\"owner\":\"25001086@N06\",\"secret\":\"a66aa40b47\",\"server\":\"4266\",\"farm\":5,\"title\":\"2017-06-04_11-49-53\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34975044961\",\"owner\":\"10136559@N00\",\"secret\":\"54679358b4\",\"server\":\"4226\",\"farm\":5,\"title\":\"Brooklyn Pop Up Dinner 2017\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34975045501\",\"owner\":\"68590723@N02\",\"secret\":\"214e37d05d\",\"server\":\"4274\",\"farm\":5,\"title\":\"IMG_7220\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34975045971\",\"owner\":\"132080943@N06\",\"secret\":\"e2d1195727\",\"server\":\"4220\",\"farm\":5,\"title\":\"DSCF4158\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"34975046561\",\"owner\":\"40129895@N03\",\"secret\":\"a918ab94f2\",\"server\":\"4205\",\"farm\":5,\"title\":\"ho2.jpg\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35065974396\",\"owner\":\"91515457@N00\",\"secret\":\"c24d0bc628\",\"server\":\"4222\",\"farm\":5,\"title\":\"Finally clean again, but in need of wax. That has to wait for another day. Still enjoy this car immensely. . . . #bmwm3 #bmwe36 #cleancar #needswax #bmw #callingtherain\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35065980126\",\"owner\":\"21040690@N07\",\"secret\":\"78c47da29b\",\"server\":\"4275\",\"farm\":5,\"title\":\"6.3.17.\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35065982176\",\"owner\":\"147499677@N08\",\"secret\":\"c007a6109f\",\"server\":\"4253\",\"farm\":5,\"title\":\"bee drinking water\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35065987516\",\"owner\":\"49118647@N08\",\"secret\":\"321380a6a8\",\"server\":\"4208\",\"farm\":5,\"title\":\"CamGrab [LW2.20170605040450.jpg]\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35065994856\",\"owner\":\"58219594@N08\",\"secret\":\"a5dd297e1d\",\"server\":\"4214\",\"farm\":5,\"title\":\"DSC_0346 -RES\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35065995156\",\"owner\":\"132327922@N08\",\"secret\":\"00e689f968\",\"server\":\"4281\",\"farm\":5,\"title\":\"132-113.Curry, con triple doble, mantiene invicto a Warriors y ventaja de 2-0\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35065995266\",\"owner\":\"151361385@N06\",\"secret\":\"2bafb615b8\",\"server\":\"4242\",\"farm\":5,\"title\":\"IMG_20170531_215822_878\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35065995316\",\"owner\":\"28051957@N04\",\"secret\":\"93c6d26f69\",\"server\":\"4240\",\"farm\":5,\"title\":\"\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35065995586\",\"owner\":\"93247780@N00\",\"secret\":\"89bf2fc315\",\"server\":\"4231\",\"farm\":5,\"title\":\"\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35065997356\",\"owner\":\"18583713@N06\",\"secret\":\"a5e69c2026\",\"server\":\"4227\",\"farm\":5,\"title\":\"evening light\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35065998516\",\"owner\":\"45676902@N00\",\"secret\":\"a37b11db57\",\"server\":\"4211\",\"farm\":5,\"title\":\"\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35066000596\",\"owner\":\"25478165@N03\",\"secret\":\"533373ee2e\",\"server\":\"4256\",\"farm\":5,\"title\":\"SAM_2033.jpg\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35066000946\",\"owner\":\"91897963@N06\",\"secret\":\"c2a9b702f5\",\"server\":\"4258\",\"farm\":5,\"title\":\"Impala Lace\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35066004216\",\"owner\":\"144242798@N08\",\"secret\":\"bb57b8a09e\",\"server\":\"4230\",\"farm\":5,\"title\":\"DSC_7972.jpg\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35105630535\",\"owner\":\"9438939@N07\",\"secret\":\"14734d81e3\",\"server\":\"4197\",\"farm\":5,\"title\":\"O fim de semana acabou e eu num li tudo o que precisava... ...como lidar? #Segunda #Estudante #Universit\\u00e1rio #VidaDeEstudante\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35105634875\",\"owner\":\"149480961@N04\",\"secret\":\"41b1bdd72c\",\"server\":\"4214\",\"farm\":5,\"title\":\"The Fearsome Three\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35105634985\",\"owner\":\"129423868@N03\",\"secret\":\"89fabf0a43\",\"server\":\"4265\",\"farm\":5,\"title\":\"201706051248\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35105637205\",\"owner\":\"92704825@N04\",\"secret\":\"915a200c39\",\"server\":\"4198\",\"farm\":5,\"title\":\"Young Bison\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35105641485\",\"owner\":\"146320613@N07\",\"secret\":\"926dc6d2f4\",\"server\":\"4278\",\"farm\":5,\"title\":\"Caption: This is Ash. He found us at my in-laws house. He loves bottle caps and drinking out of the toilet. Credit: Pebbles_red66\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35105641915\",\"owner\":\"149407314@N04\",\"secret\":\"bb8ff2309c\",\"server\":\"4243\",\"farm\":5,\"title\":\"\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35105645615\",\"owner\":\"9350462@N02\",\"secret\":\"717f87a8b3\",\"server\":\"4256\",\"farm\":5,\"title\":\"#ns #train 154 at Ray\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35105648665\",\"owner\":\"116047584@N04\",\"secret\":\"04ab985081\",\"server\":\"4271\",\"farm\":5,\"title\":\"The Mocha Corp... oh and Nova...\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35105648835\",\"owner\":\"37996574045@N01\",\"secret\":\"111bde57ef\",\"server\":\"4205\",\"farm\":5,\"title\":\"Tonight's reading selection complements of the Little Free Library down the street... #twitter #eps\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35105653295\",\"owner\":\"47131854@N04\",\"secret\":\"f664c58fc6\",\"server\":\"4284\",\"farm\":5,\"title\":\"JHS 2017 Softball Yelm 65\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35105653915\",\"owner\":\"149480415@N08\",\"secret\":\"069ec53d98\",\"server\":\"4245\",\"farm\":5,\"title\":\"image\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35105653945\",\"owner\":\"155394040@N03\",\"secret\":\"518af38b4b\",\"server\":\"4290\",\"farm\":5,\"title\":\"Colombia Pics\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35105654795\",\"owner\":\"14968334@N00\",\"secret\":\"b0c362f744\",\"server\":\"4265\",\"farm\":5,\"title\":\"Newark Fire Department Ladder 7\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35105654805\",\"owner\":\"29460210@N08\",\"secret\":\"6d761d6bf6\",\"server\":\"4254\",\"farm\":5,\"title\":\"IMG_5665\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0},{\"id\":\"35105656145\",\"owner\":\"132083481@N02\",\"secret\":\"3c532880d6\",\"server\":\"4265\",\"farm\":5,\"title\":\"RCA_5507.jpg\",\"ispublic\":1,\"isfriend\":0,\"isfamily\":0}]},\"stat\":\"ok\"}";

            JSONObject jsonBody = new JSONObject(json);
            parseItems(items, jsonBody);

            Log.i(TAG, json);
        }
        catch (IOException e) {
            Log.e(TAG, e.getMessage());
        }
        catch (JSONException e) {
            Log.e(TAG, e.getMessage());
        }

        return items;

    }

    private void parseItems(List<GalleryItem> items, JSONObject jsonBody) throws JSONException {

        JSONObject photo = jsonBody.getJSONObject("photos");
        JSONArray list = photo.getJSONArray("photo");

        for (int i = 0; i < list.length(); i++) {
            JSONObject photoObject = list.getJSONObject(i);

            GalleryItem item = new GalleryItem(photoObject.getString("id"), photoObject.getString("title"));

            if (photoObject.has("url_s")) {
                item.setUrl(photoObject.getString(("url_s")));
            }
            items.add(item);

        }
    }
}
